<!DOCTYPE html><html lang="en"><head>
        <meta charset="utf-8">
        <link rel="shortcut icon" href="#"/>
        <title>Dirty Money Alimony Submission</title>
        <script>
            function validateFormOnSubmit(f) {
                category = f.category.value;
                if(category == 'other') category = f.customCategory.value;
                console.log(category);
            }

            function validateSelection(selection) {
                console.log(selection);
            }
        </script>
        <style>
          fieldset {
            width: 50%;
            border: none;
            display: inline-block;
          }
          input {
            display: block;
          }
          select, input[type=text] {
            width: 100%;
            border: none;
            padding: 5px;
            margin: 10px;
          }
        </style>
    </head>
    <body>
        <h1>Submit to the Next Newsletter</h1>
        <form action="javascript:" onsubmit="validateFormOnSubmit(this);">
          <fieldset id="categoryField">
            <legend>Category:</legend>
            <select id="category" onchange="validateSelection(this.value)"></select>
            <script>
              var select = document.getElementById("category");
              function loadJSON(callback) {
                  var xobj = new XMLHttpRequest();
                  xobj.overrideMimeType("application/json");
                  xobj.onreadystatechange = function () {
                    if (xobj.readyState == 4 && xobj.status == "200") {
                      callback(xobj.responseText);
                    }
                  };
                  xobj.open('GET', 'submit-source.json', true);
                  xobj.send(null);  
              };
          
              loadJSON(function(response) {
                catObj = Object.values(JSON.parse(response))[0];
                for(var i=0; i<catObj.length; i++){
                  subCatObj = Object.values(catObj[i]);
                  optgroup = document.createElement("OPTGROUP");
                  optgroup.label = subCatObj[0];
                  optgroup.setAttribute("id", "optgroup" + i)
                  select.appendChild(optgroup);
                  var currentOptGroup = document.getElementById("optgroup" + i);
                  for(var j=0; j<subCatObj[1].length; j++){
                    subCat = Object.values(subCatObj[1][j]);
                    opt = document.createElement("OPTION");
                    opt.innerHTML = subCat[0];
                    currentOptGroup.appendChild(opt);
                  }
                }
              });
            </script>
          </fieldset>
          <input type="submit" value="Submit">
        </form>
    </body>
</html>